package registry

import (
	"atlas-pos/portal/script"
	"atlas-pos/portal/script/discrete"
	"errors"
	"sync"
)

type ScriptRegistry struct {
	registry map[string]script.Script
}

var once sync.Once
var scriptRegistry *ScriptRegistry

func GetScriptRegistry() *ScriptRegistry {
	once.Do(func() {
		scriptRegistry = initRegistry()
	})
	return scriptRegistry
}

func initRegistry() *ScriptRegistry {
	s := &ScriptRegistry{make(map[string]script.Script)}
	s.addPortalScript(discrete.ChristmasOut2008{})
	s.addPortalScript(discrete.Advice00{})
	s.addPortalScript(discrete.Advice01{})
	s.addPortalScript(discrete.Advice02{})
	s.addPortalScript(discrete.Advice03{})
	s.addPortalScript(discrete.Advice04{})
	s.addPortalScript(discrete.Advice05{})
	s.addPortalScript(discrete.Advice06{})
	s.addPortalScript(discrete.Advice07{})
	s.addPortalScript(discrete.Advice08{})
	s.addPortalScript(discrete.Advice09{})
	s.addPortalScript(discrete.AdviceMap{})
	s.addPortalScript(discrete.AMatchMove2{})
	s.addPortalScript(discrete.Apq00{})
	s.addPortalScript(discrete.Apq01{})
	s.addPortalScript(discrete.Apq1{})
	s.addPortalScript(discrete.Apq02{})
	s.addPortalScript(discrete.Apq2{})
	s.addPortalScript(discrete.Apq3{})
	s.addPortalScript(discrete.ApqClosed{})
	s.addPortalScript(discrete.ApqDoor{})
	s.addPortalScript(discrete.AquaPQBoss0{})
	s.addPortalScript(discrete.AranTutorAloneX{})
	s.addPortalScript(discrete.AranTutorArrow0{})
	s.addPortalScript(discrete.AranTutorArrow1{})
	s.addPortalScript(discrete.AranTutorArrow2{})
	s.addPortalScript(discrete.AranTutorArrow3{})
	s.addPortalScript(discrete.AranTutorGuide0{})
	s.addPortalScript(discrete.AranTutorGuide1{})
	s.addPortalScript(discrete.AranTutorGuide2{})
	s.addPortalScript(discrete.AranTutorLost{})
	s.addPortalScript(discrete.AranTutorMono0{})
	s.addPortalScript(discrete.AranTutorMono1{})
	s.addPortalScript(discrete.AranTutorMono2{})
	s.addPortalScript(discrete.AranTutorMono3{})
	s.addPortalScript(discrete.AranTutorOut1{})
	s.addPortalScript(discrete.AranTutorOut2{})
	s.addPortalScript(discrete.AranTutorOut3{})
	s.addPortalScript(discrete.AriantAgit{})
	s.addPortalScript(discrete.AriantCastle{})
	s.addPortalScript(discrete.AriantQueens{})
	s.addPortalScript(discrete.AriantMount{})
	s.addPortalScript(discrete.AriantMount2{})
	s.addPortalScript(discrete.BabyPigOut{})
	s.addPortalScript(discrete.BalogEnd{})
	s.addPortalScript(discrete.BalogTemple{})
	s.addPortalScript(discrete.BedroomOut{})
	s.addPortalScript(discrete.CannonTuto06{})
	s.addPortalScript(discrete.CannonTuto07{})
	s.addPortalScript(discrete.CannonTuto09{})
	s.addPortalScript(discrete.CannonTuto10{})
	s.addPortalScript(discrete.CaptinsG00{})
	s.addPortalScript(discrete.CatPriestMap{})
	s.addPortalScript(discrete.ContactDragon{})
	s.addPortalScript(discrete.CurseForest{})
	s.addPortalScript(discrete.Davy2Hd1{})
	s.addPortalScript(discrete.Davy3Hd1{})
	s.addPortalScript(discrete.DavyNext0{})
	s.addPortalScript(discrete.DavyNext1{})
	s.addPortalScript(discrete.DavyNext2{})
	s.addPortalScript(discrete.DavyNext3{})
	s.addPortalScript(discrete.DavyNext4{})
	s.addPortalScript(discrete.DepartGoBack00{})
	s.addPortalScript(discrete.DepartGoBack01{})
	s.addPortalScript(discrete.DepartGoFoward0{})
	s.addPortalScript(discrete.DepartGoFoward1{})
	s.addPortalScript(discrete.DepartToKerning{})
	s.addPortalScript(discrete.DepartTopFloor{})
	s.addPortalScript(discrete.DepartTopOut{})
	s.addPortalScript(discrete.DojangExit{})
	s.addPortalScript(discrete.DojangNext{})
	s.addPortalScript(discrete.DojangTuto{})
	s.addPortalScript(discrete.DojangUp{})
	s.addPortalScript(discrete.Dracoout{})
	s.addPortalScript(discrete.DragonEggNotice{})
	s.addPortalScript(discrete.DragonEyes{})
	s.addPortalScript(discrete.DragonNest{})
	s.addPortalScript(discrete.EBoat1{})
	s.addPortalScript(discrete.EBoat2{})
	s.addPortalScript(discrete.Elevator{})
	s.addPortalScript(discrete.ElizaGarden{})
	s.addPortalScript(discrete.EndCow{})
	s.addPortalScript(discrete.EnterEarth00{})
	s.addPortalScript(discrete.EnterEarth01{})
	s.addPortalScript(discrete.EnterNautil{})
	s.addPortalScript(discrete.EnterTd{})
	s.addPortalScript(discrete.EnterAchter{})
	s.addPortalScript(discrete.EnterBackStreet{})
	s.addPortalScript(discrete.EnterDisguise0{})
	s.addPortalScript(discrete.EnterDisguise1{})
	s.addPortalScript(discrete.EnterDisguise2{})
	s.addPortalScript(discrete.EnterDisguise3{})
	s.addPortalScript(discrete.EnterDisguise4{})
	s.addPortalScript(discrete.EnterDisguise5{})
	s.addPortalScript(discrete.EnterDollcave{})
	s.addPortalScript(discrete.EnterDollWay{})
	s.addPortalScript(discrete.EnterEvanRoom{})
	s.addPortalScript(discrete.EnterFirstDH{})
	s.addPortalScript(discrete.EnterFourthDH{})
	s.addPortalScript(discrete.EnterGym{})
	s.addPortalScript(discrete.EnterInfo{})
	s.addPortalScript(discrete.EnterMagiclibrar{})
	s.addPortalScript(discrete.EnterMCave{})
	s.addPortalScript(discrete.EnterNepenthes{})
	s.addPortalScript(discrete.EnterPort{})
	s.addPortalScript(discrete.EnterRider{})
	s.addPortalScript(discrete.EnterRienFirst{})
	s.addPortalScript(discrete.EnterSecondDH{})
	s.addPortalScript(discrete.EnterThirdDH{})
	s.addPortalScript(discrete.EnterTraining{})
	s.addPortalScript(discrete.EnterWarehouse{})
	s.addPortalScript(discrete.EnterWitch{})
	s.addPortalScript(discrete.EvanEntrance{})
	s.addPortalScript(discrete.EvanFall{})
	s.addPortalScript(discrete.EvanFarmCT{})
	s.addPortalScript(discrete.EvanGarden0{})
	s.addPortalScript(discrete.EvanGarden1{})
	s.addPortalScript(discrete.EvanLivingRoom{})
	s.addPortalScript(discrete.EvanRoom0{})
	s.addPortalScript(discrete.EvanRoom1{})
	s.addPortalScript(discrete.EvanTalk00{})
	s.addPortalScript(discrete.EvanTalk01{})
	s.addPortalScript(discrete.EvanTalk02{})
	s.addPortalScript(discrete.EvanTalk10{})
	s.addPortalScript(discrete.EvanTalk11{})
	s.addPortalScript(discrete.EvanTalk20{})
	s.addPortalScript(discrete.EvanTalk21{})
	s.addPortalScript(discrete.EvanTalk40{})
	s.addPortalScript(discrete.EvanTalk41{})
	s.addPortalScript(discrete.EvanTalk42{})
	s.addPortalScript(discrete.EvanTalk50{})
	s.addPortalScript(discrete.EvanTalk60{})
	s.addPortalScript(discrete.ExitPuppeteer{})
	s.addPortalScript(discrete.Female00{})
	s.addPortalScript(discrete.FoxLaidyMap{})
	s.addPortalScript(discrete.GagaSuccess{})
	s.addPortalScript(discrete.Gendergo{})
	s.addPortalScript(discrete.GhostGateOpen{})
	s.addPortalScript(discrete.GlpqEnter{})
	s.addPortalScript(discrete.GlpqPortal0{})
	s.addPortalScript(discrete.GlpqPortal00{})
	s.addPortalScript(discrete.GlpqPortal1{})
	s.addPortalScript(discrete.GlpqPortal01{})
	s.addPortalScript(discrete.GlpqPortal2{})
	s.addPortalScript(discrete.GlpqPortal02{})
	s.addPortalScript(discrete.GlpqPortal3{})
	s.addPortalScript(discrete.GlpqPortal03{})
	s.addPortalScript(discrete.GlpqPortal4{})
	s.addPortalScript(discrete.GlpqPortal04{})
	s.addPortalScript(discrete.GlpqPortal5{})
	s.addPortalScript(discrete.GlpqPortal6{})
	s.addPortalScript(discrete.GlpqPortal7{})
	s.addPortalScript(discrete.GlpqPortalDummy{})
	s.addPortalScript(discrete.GlTutoMsg0{})
	s.addPortalScript(discrete.GoSecretRoom{})
	s.addPortalScript(discrete.GotoCastle{})
	s.addPortalScript(discrete.Gryphius{})
	s.addPortalScript(discrete.Guild1F00{})
	s.addPortalScript(discrete.Guild1F01{})
	s.addPortalScript(discrete.Guild1F02{})
	s.addPortalScript(discrete.Guild1F03{})
	s.addPortalScript(discrete.Guild1F04{})
	s.addPortalScript(discrete.GuildWaitingEnter{})
	s.addPortalScript(discrete.GuildWaitingExit{})
	s.addPortalScript(discrete.GuyFawkes0Esc{})
	s.addPortalScript(discrete.GuyFawkes0Floor{})
	s.addPortalScript(discrete.HalloweenEnter{})
	s.addPortalScript(discrete.HalloweenOmni1{})
	s.addPortalScript(discrete.HighPosition{})
	s.addPortalScript(discrete.HorntaleBOpen{})
	s.addPortalScript(discrete.HorntaleBR{})
	s.addPortalScript(discrete.HorntaleC{})
	s.addPortalScript(discrete.HorntaleMorph2{})
	s.addPortalScript(discrete.HorntaleOut1{})
	s.addPortalScript(discrete.InXmasParty{})
	s.addPortalScript(discrete.InDragonEgg{})
	s.addPortalScript(discrete.InERShip{})
	s.addPortalScript(discrete.InfoAttack{})
	s.addPortalScript(discrete.InfoMiniMap{})
	s.addPortalScript(discrete.InfoPickup{})
	s.addPortalScript(discrete.InfoReactor{})
	s.addPortalScript(discrete.InfoSkill{})
	s.addPortalScript(discrete.InfoWorldMap{})
	s.addPortalScript(discrete.InNix1{})
	s.addPortalScript(discrete.InNix2{})
	s.addPortalScript(discrete.JailIn{})
	s.addPortalScript(discrete.JailOut{})
	s.addPortalScript(discrete.Jnr1Out{})
	s.addPortalScript(discrete.Jnr1Pt00{})
	s.addPortalScript(discrete.Jnr2Out{})
	s.addPortalScript(discrete.Jnr3In0{})
	s.addPortalScript(discrete.Jnr3In1{})
	s.addPortalScript(discrete.Jnr3Out{})
	s.addPortalScript(discrete.Jnr4R1{})
	s.addPortalScript(discrete.Jnr4R2{})
	s.addPortalScript(discrete.Jnr4R3{})
	s.addPortalScript(discrete.Jnr4R4{})
	s.addPortalScript(discrete.Jnr5Rp{})
	s.addPortalScript(discrete.Jnr6Out{})
	s.addPortalScript(discrete.Jnr12In{})
	s.addPortalScript(discrete.Jnr2010{})
	s.addPortalScript(discrete.Jnr202{})
	s.addPortalScript(discrete.JnrExit{})
	s.addPortalScript(discrete.KingGate2Open{})
	s.addPortalScript(discrete.KingGateOpen{})
	s.addPortalScript(discrete.Kpq0{})
	s.addPortalScript(discrete.Kpq1{})
	s.addPortalScript(discrete.Kpq2{})
	s.addPortalScript(discrete.Kpq3{})
	s.addPortalScript(discrete.Kpq4{})
	s.addPortalScript(discrete.LionCastleEnter{})
	s.addPortalScript(discrete.Lpq0{})
	s.addPortalScript(discrete.Lpq1{})
	s.addPortalScript(discrete.Lpq2{})
	s.addPortalScript(discrete.Lpq3{})
	s.addPortalScript(discrete.Lpq4{})
	s.addPortalScript(discrete.Lpq5{})
	s.addPortalScript(discrete.Lpq6{})
	s.addPortalScript(discrete.Lpq7{})
	s.addPortalScript(discrete.MagatiaAlc0{})
	s.addPortalScript(discrete.MagatiaDark0{})
	s.addPortalScript(discrete.Male00{})
	s.addPortalScript(discrete.MapleMarket7Out{})
	s.addPortalScript(discrete.Market00{})
	s.addPortalScript(discrete.Market01{})
	s.addPortalScript(discrete.Market02{})
	s.addPortalScript(discrete.Market03{})
	s.addPortalScript(discrete.Market04{})
	s.addPortalScript(discrete.Market05{})
	s.addPortalScript(discrete.Market06{})
	s.addPortalScript(discrete.Market07{})
	s.addPortalScript(discrete.Market08{})
	s.addPortalScript(discrete.Market09{})
	s.addPortalScript(discrete.Market10{})
	s.addPortalScript(discrete.Market11{})
	s.addPortalScript(discrete.Market12{})
	s.addPortalScript(discrete.Market13{})
	s.addPortalScript(discrete.Market14{})
	s.addPortalScript(discrete.Market15{})
	s.addPortalScript(discrete.Market16{})
	s.addPortalScript(discrete.Market17{})
	s.addPortalScript(discrete.Market18{})
	s.addPortalScript(discrete.Market19{})
	s.addPortalScript(discrete.Market20{})
	s.addPortalScript(discrete.Market21{})
	s.addPortalScript(discrete.Market22{})
	s.addPortalScript(discrete.Market23{})
	s.addPortalScript(discrete.Market24{})
	s.addPortalScript(discrete.Market26{})
	s.addPortalScript(discrete.Market52{})
	s.addPortalScript(discrete.Market53{})
	s.addPortalScript(discrete.Market54{})
	s.addPortalScript(discrete.Market55{})
	s.addPortalScript(discrete.Market56{})
	s.addPortalScript(discrete.MasteriaB11{})
	s.addPortalScript(discrete.MasteriaB21{})
	s.addPortalScript(discrete.MasteriaB31{})
	s.addPortalScript(discrete.MasteriaCC1A{})
	s.addPortalScript(discrete.MasteriaCC6A{})
	s.addPortalScript(discrete.MasteriaCM1A{})
	s.addPortalScript(discrete.MasteriaCM1B{})
	s.addPortalScript(discrete.MasteriaCM1C{})
	s.addPortalScript(discrete.MasteriaCM1D{})
	s.addPortalScript(discrete.MasteriaCM2B{})
	s.addPortalScript(discrete.MasteriaCM2C{})
	s.addPortalScript(discrete.MasteriaCM2D{})
	s.addPortalScript(discrete.MasteriaCM2E{})
	s.addPortalScript(discrete.MasteriaU21{})
	s.addPortalScript(discrete.MasteriaU31{})
	s.addPortalScript(discrete.MasteriaU51{})
	s.addPortalScript(discrete.MasteriaU52{})
	s.addPortalScript(discrete.MasteriaU61{})
	s.addPortalScript(discrete.Mayong{})
	s.addPortalScript(discrete.MC2Revive{})
	s.addPortalScript(discrete.McOut{})
	s.addPortalScript(discrete.MCRevive1{})
	s.addPortalScript(discrete.MCRevive2{})
	s.addPortalScript(discrete.MCRevive3{})
	s.addPortalScript(discrete.MCRevive4{})
	s.addPortalScript(discrete.MCRevive5{})
	s.addPortalScript(discrete.MCRevive6{})
	s.addPortalScript(discrete.MDCakeEnter{})
	s.addPortalScript(discrete.MDDrakeRoom{})
	s.addPortalScript(discrete.MDError{})
	s.addPortalScript(discrete.MDGolem{})
	s.addPortalScript(discrete.MDHigh{})
	s.addPortalScript(discrete.MDMushroom{})
	s.addPortalScript(discrete.MDPig{})
	s.addPortalScript(discrete.MDProtect{})
	s.addPortalScript(discrete.MDRabbit{})
	s.addPortalScript(discrete.MDRemember{})
	s.addPortalScript(discrete.MDRoundTable{})
	s.addPortalScript(discrete.MDSand{})
	s.addPortalScript(discrete.MDTreasure{})
	s.addPortalScript(discrete.MetIn{})
	s.addPortalScript(discrete.MetOut{})
	s.addPortalScript(discrete.MetalGateOpen{})
	s.addPortalScript(discrete.MetroChat00{})
	s.addPortalScript(discrete.MetroIn00{})
	s.addPortalScript(discrete.MinrarElli{})
	s.addPortalScript(discrete.MinrarJob4{})
	s.addPortalScript(discrete.MirTalk00{})
	s.addPortalScript(discrete.MirTalk01{})
	s.addPortalScript(discrete.MoveElin{})
	s.addPortalScript(discrete.MoveBefore{})
	s.addPortalScript(discrete.MoveNext{})
	s.addPortalScript(discrete.NetsIn{})
	s.addPortalScript(discrete.NetsOut{})
	s.addPortalScript(discrete.NextMap{})
	s.addPortalScript(discrete.OBoat1{})
	s.addPortalScript(discrete.OBoat2{})
	s.addPortalScript(discrete.Obstacle{})
	s.addPortalScript(discrete.OutPepeKing{})
	s.addPortalScript(discrete.OutArchterMap{})
	s.addPortalScript(discrete.OutChild{})
	s.addPortalScript(discrete.OutDarkEreb{})
	s.addPortalScript(discrete.OutMagicLib{})
	s.addPortalScript(discrete.OutMaha{})
	s.addPortalScript(discrete.OutNix1{})
	s.addPortalScript(discrete.OutNix2{})
	s.addPortalScript(discrete.OutPerrion1{})
	s.addPortalScript(discrete.OutPerrion2{})
	s.addPortalScript(discrete.OutRider{})
	s.addPortalScript(discrete.OutSpecialSchool{})
	s.addPortalScript(discrete.OutTemple{})
	s.addPortalScript(discrete.OutTestWolf{})
	s.addPortalScript(discrete.Party3GardenIn{})
	s.addPortalScript(discrete.Party3Jail1{})
	s.addPortalScript(discrete.Party3Jail2{})
	s.addPortalScript(discrete.Party3Jail3{})
	s.addPortalScript(discrete.Party3JailIn{})
	s.addPortalScript(discrete.Party3R4pt{})
	s.addPortalScript(discrete.Party3R4pt1{})
	s.addPortalScript(discrete.Party3R6pt{})
	s.addPortalScript(discrete.Party3Room1{})
	s.addPortalScript(discrete.Party3Room2{})
	s.addPortalScript(discrete.Party3Room3{})
	s.addPortalScript(discrete.Party3Room4{})
	s.addPortalScript(discrete.Party3Room5{})
	s.addPortalScript(discrete.Party3Room6{})
	s.addPortalScript(discrete.Party3Room8{})
	s.addPortalScript(discrete.Party3RoomOut{})
	s.addPortalScript(discrete.Party6Out{})
	s.addPortalScript(discrete.Party6Stage{})
	s.addPortalScript(discrete.Party6Stage501{})
	s.addPortalScript(discrete.Party6Stage502{})
	s.addPortalScript(discrete.Party6Stage503{})
	s.addPortalScript(discrete.Party6Stage504{})
	s.addPortalScript(discrete.Party6Stage505{})
	s.addPortalScript(discrete.Party6Stage506{})
	s.addPortalScript(discrete.Party6Stage507{})
	s.addPortalScript(discrete.Party6Stage508{})
	s.addPortalScript(discrete.Party6Stage509{})
	s.addPortalScript(discrete.Party6Stage510{})
	s.addPortalScript(discrete.Party6Stage511{})
	s.addPortalScript(discrete.Party6Stage512{})
	s.addPortalScript(discrete.Party6Stage513{})
	s.addPortalScript(discrete.Party6Stage514{})
	s.addPortalScript(discrete.Party6Stage515{})
	s.addPortalScript(discrete.Party6Stage800{})
	
	s.addPortalScript(discrete.TutoChatNPC{})
	return s
}

func (s *ScriptRegistry) GetScript(name string) (*script.Script, error) {
	if val, ok := s.registry[name]; ok {
		return &val, nil
	}
	return nil, errors.New("unable to locate script")
}

func (s *ScriptRegistry) addPortalScript(handler script.PortalScript) {
	s.registry[handler.Name()] = script.NewScript(handler)
}
